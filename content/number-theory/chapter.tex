\chapter{Number Theory}


\section{Primes}
\begin{verbatim}
< 10^k    prime   # of prime
----------------------------
1             7            4
2            97           25
3           997          168
4          9973         1229
5         99991         9592
6        999983        78498
7       9999991       664579
8      99999989      5761455
9     999999937     50847534

\end{verbatim}
	Primitive roots exist modulo any prime power $p^a$, except for $p = 2, a > 2$, and there are $\phi(\phi(p^a))$ many.
	For $p = 2, a > 2$, the group $\mathbb Z_{2^a}^\times$ is instead isomorphic to $\mathbb Z_2 \times \mathbb Z_{2^{a-2}}$.

\section{Estimates}
	$\sum_{d|n} d = O(n \log \log n)$.

	The number of divisors of $n$ is at most around 100 for $n < 5e4$, 500 for $n < 1e7$, 2000 for $n < 1e10$, 200\,000 for $n < 1e19$.

\section{Modular arithmetic}
	\kactlimport{ModInverse.h}
	\kactlimport{ModPow.h}
	\kactlimport{ModLog.h}
	\kactlimport{ModSum.h}
	\kactlimport{ModSqrt.h}

\section{Primality}
	\kactlimport{FastEratosthenes.h}
	\kactlimport{MillerRabin.h}
	\kactlimport{Factor.h}

\section{Divisibility}
	\kactlimport{euclid.h}
	\kactlimport{CRT.h}

	\subsection{BÃ©zout's identity}
	For $a \neq $, $b \neq 0$, then $d=gcd(a,b)$ is the smallest positive integer for which there are integer solutions to
	$$ax+by=d$$
	If $(x,y)$ is one solution, then all solutions are given by
	$$\left(x+\frac{kb}{\gcd(a,b)}, y-\frac{ka}{\gcd(a,b)}\right), \quad k\in\mathbb{Z}$$


\section{Fractions}
	\kactlimport{ContinuedFractions.h}
	\kactlimport{FracBinarySearch.h}


\section{Mobius Function / Dirichlet Convolution}
\paragraph{Dirichlet Convolution}
For $f, g : \mathbb{N} \to \mathbb{C}$, we define 
$$(f * g)(n) = \sum_{d \mid n} f(d) g(n / d) = \sum_{ab = n} f(a)g(b)$$  
Set of arithmetic functions form a commutative ring under pointwise addition and Dirichlet convolution, equipped with the multiplicative identity $\epsilon(n) = \chi_{\{1\}}(n)$. In this ring, we have $\mathbf{1} * \mu = \epsilon$ for the Mobius function $\mu$:
$$
	\mu(n) = \begin{cases} 0 & n \textrm{ is not square free}\\ 1 & n \textrm{ has even number of prime factors}\\ -1 & n \textrm{ has odd number of prime factors}\\\end{cases}
$$
And also sum of divisor function $\sigma = id * \mathbf{1}$, number of divisors $d = 1 * 1$ gives $id = \sigma * \mu, \mathbf{1} = d * \mu$. 

Finally, the Mobius inversion formula 
$$g = f * \mathbf{1} \iff f = g * \mu$$
$$g(n) = \sum_{d \mid n} f(d) \iff f(n) = \sum_{d \mid n} \mu(d)g(n/d)$$
\paragraph{Xudyh's Sieve : Setting}
(1) For a multiplicative function $f$ ($f(ab) = f(a)f(b)$ when $\gcd(a, b) = 1$), $s_f$ can be computed in linear time
(2) There exists a function $g$ such that, $s_g$ and $s_{f * g}$ can be evaluated super fast. 

\kactlimport{XudyhSieve.h}